# 任意 mod での二項係数列挙

二項係数 ${}_NC_i\bmod M\;(0\leq i\leq N)$ を列挙する. $M$ は合成数でもよい.

## ArbitaryModBinom1

概要 : 素因数分解形で値を持ち, セグ木で積を復元する.

計算量 : $\displaystyle O(N(\log N)(\log\log N))$

## ArbitaryModBinom2

概要 : $M$ と素因数を共有する部分のみ素因数分解形で持ち, 他は逆元を用いて計算する.

計算量 : $\displaystyle O\left(\frac{N\log M}{\log\log M}\right)$

## ArbitaryModBinom3

概要 : `ArbitaryModBinom2` において素因数分解形の部分の積をセグ木で管理するようにする.

計算量 : $\displaystyle O\left(N(\log\log M)(\log\log\log M)\right)$

## (参考) パフォーマンス比較

右 3 列は順に `ArbitaryModBinom1`, `ArbitaryModBinom2`, `ArbitaryModBinom3` の実行時間 (単位は ms). 一度きりの計測値なので, あくまで参考程度にして下さい.

|$N$|$M$|1|2|3|
|--:|--:|--:|--:|--:|
|$10^4$|$10^0$|$24$|$13$|$4$|
|$10^4$|$10^1$|$6$|$12$|$18$|
|$10^4$|$10^2$|$4$|$4$|$4$|
|$10^4$|$10^3$|$4$|$5$|$3$|
|$10^4$|$10^4$|$5$|$2$|$3$|
|$10^4$|$10^5$|$5$|$2$|$2$|
|$10^4$|$10^6$|$5$|$2$|$1$|
|$10^4$|$10^7$|$4$|$2$|$1$|
|$10^4$|$10^8$|$4$|$2$|$1$|
|$10^4$|$10^9$|$5$|$2$|$2$|
|$10^4$|$2$|$3$|$1$|$1$|
|$10^4$|$2\cdot3$|$4$|$2$|$2$|
|$10^4$|$2\cdot3\cdot5$|$4$|$2$|$1$|
|$10^4$|$2\cdot3\cdot5\cdot7$|$5$|$2$|$3$|
|$10^4$|$2\cdot3\cdot5\cdot7\cdot11$|$4$|$2$|$2$|
|$10^4$|$2\cdot3\cdot5\cdot7\cdot11\cdot13$|$5$|$3$|$3$|
|$10^4$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17$|$4$|$2$|$2$|
|$10^4$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17\cdot19$|$4$|$3$|$2$|
|$10^4$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17\cdot19\cdot23$|$4$|$3$|$2$|
|$10^5$|$10^0$|$41$|$1$|$0$|
|$10^5$|$10^1$|$35$|$10$|$14$|
|$10^5$|$10^2$|$40$|$9$|$16$|
|$10^5$|$10^3$|$39$|$9$|$19$|
|$10^5$|$10^4$|$37$|$12$|$19$|
|$10^5$|$10^5$|$44$|$12$|$20$|
|$10^5$|$10^6$|$43$|$9$|$11$|
|$10^5$|$10^7$|$39$|$10$|$11$|
|$10^5$|$10^8$|$38$|$10$|$12$|
|$10^5$|$10^9$|$47$|$11$|$14$|
|$10^5$|$2$|$41$|$6$|$10$|
|$10^5$|$2\cdot3$|$36$|$9$|$12$|
|$10^5$|$2\cdot3\cdot5$|$40$|$10$|$15$|
|$10^5$|$2\cdot3\cdot5\cdot7$|$38$|$15$|$16$|
|$10^5$|$2\cdot3\cdot5\cdot7\cdot11$|$36$|$11$|$16$|
|$10^5$|$2\cdot3\cdot5\cdot7\cdot11\cdot13$|$36$|$13$|$17$|
|$10^5$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17$|$37$|$13$|$19$|
|$10^5$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17\cdot19$|$36$|$14$|$20$|
|$10^5$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17\cdot19\cdot23$|$40$|$16$|$16$|
|$10^6$|$10^0$|$550$|$1$|$1$|
|$10^6$|$10^1$|$473$|$71$|$72$|
|$10^6$|$10^2$|$445$|$65$|$70$|
|$10^6$|$10^3$|$428$|$64$|$62$|
|$10^6$|$10^4$|$420$|$68$|$72$|
|$10^6$|$10^5$|$433$|$69$|$72$|
|$10^6$|$10^6$|$464$|$73$|$68$|
|$10^6$|$10^7$|$427$|$67$|$77$|
|$10^6$|$10^8$|$417$|$79$|$69$|
|$10^6$|$10^9$|$418$|$84$|$65$|
|$10^6$|$2$|$422$|$49$|$55$|
|$10^6$|$2\cdot3$|$410$|$70$|$62$|
|$10^6$|$2\cdot3\cdot5$|$420$|$81$|$80$|
|$10^6$|$2\cdot3\cdot5\cdot7$|$409$|$94$|$93$|
|$10^6$|$2\cdot3\cdot5\cdot7\cdot11$|$448$|$110$|$102$|
|$10^6$|$2\cdot3\cdot5\cdot7\cdot11\cdot13$|$403$|$108$|$109$|
|$10^6$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17$|$436$|$118$|$115$|
|$10^6$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17\cdot19$|$412$|$127$|$112$|
|$10^6$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17\cdot19\cdot23$|$435$|$120$|$128$|
|$10^7$|$10^0$|$5297$|$11$|$10$|
|$10^7$|$10^1$|$5437$|$610$|$594$|
|$10^7$|$10^2$|$5472$|$547$|$573$|
|$10^7$|$10^3$|$5475$|$588$|$566$|
|$10^7$|$10^4$|$5453$|$590$|$629$|
|$10^7$|$10^5$|$5441$|$786$|$758$|
|$10^7$|$10^6$|$5449$|$639$|$631$|
|$10^7$|$10^7$|$5972$|$648$|$624$|
|$10^7$|$10^8$|$5667$|$643$|$657$|
|$10^7$|$10^9$|$5465$|$648$|$646$|
|$10^7$|$2$|$5481$|$446$|$454$|
|$10^7$|$2\cdot3$|$5622$|$568$|$567$|
|$10^7$|$2\cdot3\cdot5$|$5932$|$721$|$740$|
|$10^7$|$2\cdot3\cdot5\cdot7$|$5459$|$895$|$870$|
|$10^7$|$2\cdot3\cdot5\cdot7\cdot11$|$5466$|$978$|$983$|
|$10^7$|$2\cdot3\cdot5\cdot7\cdot11\cdot13$|$5492$|$1026$|$1033$|
|$10^7$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17$|$5482$|$1110$|$1125$|
|$10^7$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17\cdot19$|$5457$|$1191$|$1144$|
|$10^7$|$2\cdot3\cdot5\cdot7\cdot11\cdot13\cdot17\cdot19\cdot23$|$5490$|$1229$|$1262$|
